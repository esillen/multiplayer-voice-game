<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{fragments/header :: head('Space Invaders - Voice Game')}"></head>
<body>
    <div class="scanlines"></div>
    <div class="container play-container">
        <header th:replace="~{fragments/header :: navbar}"></header>
        
        <main class="game-page spaceinvaders-page">
            <div class="game-header">
                <div class="score-display">
                    <span>SCORE: <span id="score">0</span></span>
                    <span>WAVE: <span id="wave">1</span></span>
                    <span>LIVES: <span id="lives">❤️❤️❤️</span></span>
                </div>
            </div>
            
            <div class="game-canvas-container">
                <canvas id="gameCanvas" width="800" height="600"></canvas>
                
                <div id="gameOverlay" class="game-overlay">
                    <div class="overlay-content" id="overlayContent">
                        <h2>SPACE INVADERS</h2>
                        <p>Enemies come from the RIGHT</p>
                        <p>Sing HIGH to move UP, LOW to move DOWN</p>
                        <p>Sing NORMAL to SHOOT</p>
                        <button id="startBtn" class="btn btn-primary btn-large">
                            <span>START GAME</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Pitch Threshold Bar -->
            <div class="pitch-meter-section game-pitch-meter">
                <div class="pitch-meter-container">
                    <div class="pitch-scale">
                        <span>60 Hz</span>
                        <span>200 Hz</span>
                        <span>350 Hz</span>
                        <span>500 Hz</span>
                    </div>
                    <div class="pitch-meter-bar" id="pitchMeterBar">
                        <div class="pitch-marker" id="pitchMarker"></div>
                        <div class="threshold-marker high-threshold" id="highThreshold" draggable="true">
                            <div class="threshold-handle"></div>
                            <span class="threshold-label">HIGH</span>
                        </div>
                        <div class="threshold-marker low-threshold" id="lowThreshold" draggable="true">
                            <div class="threshold-handle"></div>
                            <span class="threshold-label">LOW</span>
                        </div>
                        <div class="zone-fill low-zone-fill" id="lowZoneFill"></div>
                        <div class="zone-fill high-zone-fill" id="highZoneFill"></div>
                    </div>
                    <div class="zone-labels">
                        <span class="zone-label low">LOW</span>
                        <span class="zone-label mid">NORMAL (SHOOT)</span>
                        <span class="zone-label high">HIGH</span>
                    </div>
                </div>
                <div class="current-pitch">
                    <span id="currentFrequency">-- Hz</span>
                    <span id="currentPitchLabel" class="pitch-state">WAITING</span>
                </div>
            </div>
        </main>
        
        <footer th:replace="~{fragments/footer :: footer}"></footer>
    </div>
    
    <script th:src="@{/js/pitch-detector.js}"></script>
    <script th:src="@{/js/spaceinvaders.js}"></script>
</body>
</html>

